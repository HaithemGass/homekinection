<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BitCloud Stack API Reference: apsdeEndpoint.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BitCloud Stack API Reference&#160;<span id="projectnumber">1.11.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">apsdeEndpoint.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Interface of APS Endpoint SAP.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="app_framework_8h_source.html">appFramework.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="apsde_data_8h_source.html">apsdeData.h</a>&gt;</code><br/>
</div>
<p><a href="apsde_endpoint_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters of the <a class="el" href="apsde_endpoint_8h.html#ad5e605753e1707e9caecb218e6cb4a7b" title="Registers a new endpoint in the APS layer.">APS_RegisterEndpointReq()</a> function.  <a href="struct_a_p_s___register_endpoint_req__t.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_s___unregister_endpoint_req__t.html">APS_UnregisterEndpointReq_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters of the <a class="el" href="apsde_endpoint_8h.html#a36d0e55efedd5c7e391ddce10695afa8" title="Unregisters an endpoint from the APS layer.">APS_UnregisterEndpointReq()</a> function.  <a href="struct_a_p_s___unregister_endpoint_req__t.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a09a1a0eb07dffb620c2c57bf1a335cdf"></a><!-- doxytag: member="apsdeEndpoint.h::APS_EndpointReg_t" ref="a09a1a0eb07dffb620c2c57bf1a335cdf" args="" -->
typedef <a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>APS_EndpointReg_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adac53e64b69749a30523b19a1a74a356"></a><!-- doxytag: member="apsdeEndpoint.h::APS_EndpointUnreg_t" ref="adac53e64b69749a30523b19a1a74a356" args="" -->
typedef <a class="el" href="struct_a_p_s___unregister_endpoint_req__t.html">APS_UnregisterEndpointReq_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>APS_EndpointUnreg_t</b></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apsde_endpoint_8h.html#ad5e605753e1707e9caecb218e6cb4a7b">APS_RegisterEndpointReq</a> (<a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a> *const req)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a new endpoint in the APS layer.  <a href="#ad5e605753e1707e9caecb218e6cb4a7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apsde_endpoint_8h.html#a36d0e55efedd5c7e391ddce10695afa8">APS_UnregisterEndpointReq</a> (<a class="el" href="struct_a_p_s___unregister_endpoint_req__t.html">APS_UnregisterEndpointReq_t</a> *const req)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregisters an endpoint from the APS layer.  <a href="#a36d0e55efedd5c7e391ddce10695afa8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apsde_endpoint_8h.html#a37c9fc2e3eceef1f27559ab5efa69c87">APS_NextEndpoint</a> (const <a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a> *const prev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get next registered endpoint descriptor by previous.  <a href="#a37c9fc2e3eceef1f27559ab5efa69c87"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apsde_endpoint_8h.html#a72972ae4e955a5f249aa64e23a5b0f79">APS_StopEndpointIndication</a> (const Endpoint_t endpoint)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops APS Data indications of specific endpoint number.  <a href="#a72972ae4e955a5f249aa64e23a5b0f79"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apsde_endpoint_8h.html#accb3b92dde84e5918cd777ed6837daec">APS_ResumeEndpointIndication</a> (const Endpoint_t endpoint)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Resumes APS Data indications of specific endpoint number.  <a href="#accb3b92dde84e5918cd777ed6837daec"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Interface of APS Endpoint SAP. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Atmel Corporation: <a href="http://www.atmel.com">http://www.atmel.com</a> <br/>
 Support email: <a href="mailto:avr@atmel.com">avr@atmel.com</a></dd></dl>
<p>Copyright (c) 2008-2011, Atmel Corporation. All rights reserved. Licensed under Atmel's Limited License Agreement (BitCloudTM). </p>

<p>Definition in file <a class="el" href="apsde_endpoint_8h_source.html">apsdeEndpoint.h</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ad5e605753e1707e9caecb218e6cb4a7b"></a><!-- doxytag: member="apsdeEndpoint.h::APS_RegisterEndpointReq" ref="ad5e605753e1707e9caecb218e6cb4a7b" args="(APS_RegisterEndpointReq_t *const req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void APS_RegisterEndpointReq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a> *const&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Registers a new endpoint in the APS layer. </p>
<p>The function is used to register an application endpoint. In order to take part in network communication the application on the device must register at least one endpoint, since data exchange on the application level occurs between two endpoints registered on two nodes, which in fact can be a single node as well.</p>
<p>The function call is done synchronously. The function simply writes an entry containing endpoint information to a dedicated internal structure. The request parameters for the funciton include simple descriptor configuration, a pointer to the indication callback function, which is to be called upon data reception addressed to the endpoint, and a status field, which is written by the stack.</p>
<p>See the example of request parameters configuration and function usage: </p>
<div class="fragment"><pre class="fragment"><span class="comment">//Global definitions</span>
<span class="keyword">static</span> ClusterId_t clustersTable[] = {0}; <span class="comment">//The list of clusters that the endpoint will support</span>

<span class="comment">//Configure the simple descriptor of the endpoint</span>
<span class="keyword">static</span> <a class="code" href="struct_simple_descriptor__t.html" title="Simple Descriptor.">SimpleDescriptor_t</a> simpleDescriptor =
{
  .<a class="code" href="struct_simple_descriptor__t.html#a983c8e6db56e62edd64e8985c36b7cac">endpoint</a> = APP_ENDPOINT, <span class="comment">//Endpoint ID, an arbitrary number between 1 and 240</span>
  .AppDeviceVersion = 1,
  .AppInClustersCount = 1, <span class="comment">//The number of suppoted input clusters</span>
  .AppInClustersList = clustersTable,  <span class="comment">//The list of supported input clusters</span>
  .AppOutClustersCount = 0,
  .AppOutClustersList = NULL, <span class="comment">//Suppose out clusters are not supported</span>
};

<span class="comment">//Configure parameters for endpoint registration request</span>
<span class="keyword">static</span> <a class="code" href="struct_a_p_s___register_endpoint_req__t.html" title="Parameters of the APS_RegisterEndpointReq() function.">APS_RegisterEndpointReq_t</a> endpointDesc =
{
  .<a class="code" href="struct_a_p_s___register_endpoint_req__t.html#a0f59b6a67d5ba5957aedc565f5db1fac">simpleDescriptor</a> = &amp;simpleDescriptor,
  .APS_DataInd = APS_DataInd,
};

<span class="comment">//Data indication callback definition</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> APS_DataInd(<a class="code" href="struct_a_p_s___data_ind__t.html" title="The structure for indication of data reception.">APS_DataInd_t</a> *ind)
{
  <span class="comment">//Perform appropriate actions, for example, switch on the value of </span>
  <span class="comment">//cluster specified in the received frame</span>
  <span class="keywordflow">switch</span> (ind-&gt;<a class="code" href="struct_a_p_s___data_ind__t.html#a9fa5bf20bb19a53c2cf90d2421490cb1">clusterId</a>)
  {
    <span class="keywordflow">case</span> CPU_TO_LE16(APP_CLUSTER_ONE):
    ...
    case CPU_TO_LE16(APP_CLUSTER_TWO):
    ...
  }
}
...
simpleDescriptor.AppProfileId = CPU_TO_LE16(APP_PROFILE_ID);
simpleDescriptor.<a class="code" href="struct_simple_descriptor__t.html#a82725380f3c264735ab5bbc6abd0a8d3">AppDeviceId</a> = CPU_TO_LE16(1);

<a class="code" href="apsde_endpoint_8h.html#ad5e605753e1707e9caecb218e6cb4a7b" title="Registers a new endpoint in the APS layer.">APS_RegisterEndpointReq</a>(&amp;endpointDesc);
</pre></div><p> Although it is not required that a variable for the simple descriptor is static or simply defined in the global scope, it may be convenient to do so to keep track of the endpoint. Note the use of the CPU_TO_LE16 macro which converts a 16-bit value to a 16-bit little-endian value. Backward convertion is performed with the LE16_TO_CPU macro.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">req</td><td>- pointer to the endpoint registration request parameters</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>APS_SUCCESS_STATUS in req-&gt;status if registration is a success, otherwise, APS_INVALID_PARAMETER_STATUS. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="aps_common_8h.html#a1b4ff3a412400f1920d4d56e771230c8" title="APS status values.">APS_Status_t</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a36d0e55efedd5c7e391ddce10695afa8"></a><!-- doxytag: member="apsdeEndpoint.h::APS_UnregisterEndpointReq" ref="a36d0e55efedd5c7e391ddce10695afa8" args="(APS_UnregisterEndpointReq_t *const req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void APS_UnregisterEndpointReq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_s___unregister_endpoint_req__t.html">APS_UnregisterEndpointReq_t</a> *const&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unregisters an endpoint from the APS layer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">req</td><td>- pointer to the endpoint unregistering request parameters</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>APS_SUCCESS_STATUS in req-&gt;status if unregistration is a success, otherwise, APS_INVALID_PARAMETER_STATUS. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="aps_common_8h.html#a1b4ff3a412400f1920d4d56e771230c8" title="APS status values.">APS_Status_t</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a37c9fc2e3eceef1f27559ab5efa69c87"></a><!-- doxytag: member="apsdeEndpoint.h::APS_NextEndpoint" ref="a37c9fc2e3eceef1f27559ab5efa69c87" args="(const APS_RegisterEndpointReq_t *const prev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a>* APS_NextEndpoint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_p_s___register_endpoint_req__t.html">APS_RegisterEndpointReq_t</a> *const&#160;</td>
          <td class="paramname"><em>prev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get next registered endpoint descriptor by previous. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prev</td><td>- previous endpoint descriptor pointer.It is must be non NULL sequential access required if. And it is must be NULL the first descriptor as registered endpoints queue head element access required if.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Valid endpoint descriptor pointer descriptor found if, NULL - other case. </dd></dl>

</div>
</div>
<a class="anchor" id="a72972ae4e955a5f249aa64e23a5b0f79"></a><!-- doxytag: member="apsdeEndpoint.h::APS_StopEndpointIndication" ref="a72972ae4e955a5f249aa64e23a5b0f79" args="(const Endpoint_t endpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void APS_StopEndpointIndication </td>
          <td>(</td>
          <td class="paramtype">const Endpoint_t&#160;</td>
          <td class="paramname"><em>endpoint</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stops APS Data indications of specific endpoint number. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">endpoint</td><td>- the registered endpoint number. The 0xff special value means all registered endpoints. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="accb3b92dde84e5918cd777ed6837daec"></a><!-- doxytag: member="apsdeEndpoint.h::APS_ResumeEndpointIndication" ref="accb3b92dde84e5918cd777ed6837daec" args="(const Endpoint_t endpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void APS_ResumeEndpointIndication </td>
          <td>(</td>
          <td class="paramtype">const Endpoint_t&#160;</td>
          <td class="paramname"><em>endpoint</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resumes APS Data indications of specific endpoint number. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">endpoint</td><td>- the registered endpoint number. The 0xff special value means all registered endpoints. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

</div>
</div>
</div>
<img src="footer.png" style="margin-top:20px"/>
</body>
</html>
